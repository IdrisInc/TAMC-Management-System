{% extends "base/base.html" %}
{% load custom_filters %}

{% block title %}
    <title> TAMC | Holiday Request </title>
{% endblock title %}
{% block content %}

<div class="content-wrapper">
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <h1>Holiday Requests</h1>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">Holiday Request</li>
                    </ol>
                </div>
            </div>
        </div>
    </section>
    
    <section class="content">  
        <div class="container-fluid">
            <div class="toggle-container">
                <div class="row justify-content-between text-center text-md-start mb-3">
                    <div class="col-12 col-sm-6 col-md-3 mb-2">
                        <label class="button-toggle d-flex align-items-center justify-content-center justify-content-md-start">
                            <input type="checkbox" id="toggle-delegated-holidays" onchange="toggleVisibility('delegated-holidays-section')">
                            <span class="btn-text ms-2">Delegated Holidays</span>
                        </label>
                    </div>
                    <div class="col-12 col-sm-6 col-md-3 mb-2">
                        <label class="button-toggle d-flex align-items-center justify-content-center justify-content-md-start">
                            <input type="checkbox" id="toggle-approved-delegated-holidays" onchange="toggleVisibility('approved-delegated-holidays-section')">
                            <span class="btn-text ms-2">Approved Holidays</span>
                        </label>
                    </div>
                    {% if visible_switches.show_holidays_for_approval %}
                    <div class="col-12 col-sm-6 col-md-3 mb-2">
                        <label class="button-toggle d-flex align-items-center justify-content-center justify-content-md-start">
                            <input type="checkbox" id="toggle-holidays-for-approval" onchange="toggleVisibility('holidays-for-approval-section')">
                            <span class="btn-text ms-2">Approve Holiday</span>
                        </label>
                    </div>
                    {% endif %}
                    <div class="col-12 col-sm-6 col-md-3 mb-2">
                        <label class="button-toggle d-flex align-items-center justify-content-center justify-content-md-start">
                            <input type="checkbox" id="toggle-your-holidays" onchange="toggleVisibility('your-holidays-section')">
                            <span class="btn-text ms-2">My Holidays</span>
                        </label>
                    </div>
                </div>
            </div>
            

            <div id="your-holidays-section" style="display: none;">
            <div class="container-fluid" id='user-requests'>
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                {% if messages %}
                                    {% for message in messages %}
                                        {{ message }}
                                    {% endfor %}
                                {% endif %}
                                <h3 class="card-title">My Vacation Requests</h3>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-bordered" id="user-holidays-table">
                                    <thead>
                                        <tr>
                                            <th>Holiday Type</th>
                                            <th>Duration</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for holiday in user_holidays %}
                                        <tr>
                                            <td>{{ holiday.get_holiday_type_display }}</td>
                                            <td>
                                                <span class="duration" data-start-date="{{ holiday.start_date }}" data-end-date="{{ holiday.end_date }}">
                                                    {{ holiday.start_date }} to {{ holiday.end_date }} 
                                                    (<span class="number-of-days">{{ holiday.get_duration }}</span> days)
                                                </span>
                                            </td>
                                            <td>{{ holiday.get_status_display }}</td>
                                            <td>
                                                <button class="btn btn-info" data-toggle="modal" data-target="#holidayModal-{{ holiday.id }}">View More</button>
                                            </td>
                                        </tr>

                                        <!-- View More Modal -->
                                        <div class="modal fade" id="holidayModal-{{ holiday.id }}" tabindex="-1" role="dialog" aria-labelledby="holidayModalLabel-{{ holiday.id }}" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="holidayModalLabel-{{ holiday.id }}">Holiday Details</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <p><strong>Holiday For:</strong> {{ holiday.get_holiday_type_display }}</p>
                                                        <p><strong>My Address:</strong> {{ holiday.address }}</p>
                                                        <p><strong>Delegatee:</strong> {{ holiday.delegatee.get_full_name }}</p>
                                                        <p><strong>My Duty(ies) :</strong>
                                                            {% if holiday.my_tasks %}
                                                                <ul>
                                                                    {% for task in holiday.my_tasks|split_string %}
                                                                        <li>{{ task|escape }}</li>  <!-- escape ensures safe rendering -->
                                                                    {% empty %}
                                                                        <li>No tasks assigned.</li>
                                                                    {% endfor %}
                                                                </ul>
                                                            {% else %}
                                                                <li>No tasks assigned.</li>
                                                            {% endif %}
                                                        </p>
                                                        
                                                        <p class="duration" 
                                                           data-start-date="{{ holiday.start_date }}" 
                                                           data-end-date="{{ holiday.end_date }}">
                                                           <strong>Holiday Duration:</strong> {{ holiday.start_date }} - {{ holiday.end_date }} 
                                                           <span class="days-text"></span>
                                                        </p>
                                                        <p><strong>My last Holiday:</strong> {{ holiday.my_last_holiday_start }} - {{ holiday.my_last_holiday_end }}</p>
                                                        <p><strong>Status:</strong> {{ holiday.get_status_display }}</p> 
                                                        <p><strong>Current Address:</strong> {{ holiday.current_address }}</p>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                        {% if holiday.status == 'pending' %}
                                                            <a href="{% url 'vacation:edit_holiday' holiday.id %}" class="btn btn-warning">Edit</a>
                                                            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteHolidayModal-{{ holiday.id }}">Delete</button>
                                                        {% endif %}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        

                                        <!-- Delete Confirmation Modal -->
                                        <div class="modal fade" id="deleteHolidayModal-{{ holiday.id }}" tabindex="-1" role="dialog" aria-labelledby="deleteHolidayModalLabel-{{ holiday.id }}" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="deleteHolidayModalLabel-{{ holiday.id }}">Confirm Delete</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        Are you sure you want to delete this holiday?
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                        <form method="POST" action="{% url 'vacation:delete_holiday' holiday.id %}">
                                                            {% csrf_token %}
                                                            <button type="submit" class="btn btn-danger">Delete</button>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% empty %}
                                        <tr>
                                            <td colspan="4">You have no holiday requests.</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
        
                                <!-- Pagination Controls -->
                                <div class="pagination-controls" id="user-holidays-pagination">
                                    <button class="btn btn-secondary" id="prev-user-holidays">Previous</button>
                                    <span id="page-number-user-holidays">Page 1</span>
                                    <button class="btn btn-secondary" id="next-user-holidays">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="approved-delegated-holidays-section" style = "display:none">
            {% if approved_delegated_holidays %}
            <div class="container-fluid" id='user-requests'>
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                {% if messages %}
                                    {% for message in messages %}
                                        {{ message }}
                                    {% endfor %}
                                {% endif %}
                                <h3 class="card-title">Approved Vacation Requests</h3>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-bordered" id="approved-delegated-holidays-table">
                                    <thead>
                                        <tr>
                                            <th>Requester</th>
                                            <th>Holiday Type</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for holiday in approved_delegated_holidays %}
                                        <tr>
                                            <td>{{ holiday.user.get_full_name }}</td>
                                            <td>{{ holiday.get_holiday_type_display }}</td>
                                            <td>{{ holiday.get_status_display }}</td>
                                            <td>
                                                <button class="btn btn-info" data-toggle="modal" data-target="#approvedHolidayModal-{{ holiday.id }}">View More</button>
                                            </td>
                                        </tr>

                                        <!-- Modal for Approved Delegated Holiday -->
                                        <div class="modal fade" id="approvedHolidayModal-{{ holiday.id }}" tabindex="-1" role="dialog" aria-labelledby="approvedHolidayModalLabel-{{ holiday.id }}" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="approvedHolidayModalLabel-{{ holiday.id }}">Holiday Details</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <p><strong>Request From:</strong> {{ holiday.user.get_full_name }}</p>
                                                        <p><strong>Holiday For:</strong> {{ holiday.get_holiday_type_display }}</p>
                                                        <p><strong>Delegatee:</strong> {{ holiday.delegatee.get_full_name }}</p>
                                                        <p class="duration" 
                                                        data-start-date="{{ holiday.start_date }}" 
                                                        data-end-date="{{ holiday.end_date }}">
                                                        <strong>Duration:</strong>
                                                        {{ holiday.start_date }} - {{ holiday.end_date }} 
                                                        <span class="days-text"></span>
                                                     </p>
                                                     <p><strong>His/Her Duty(ies)  :</strong>
                                                        {% if holiday.my_tasks %}
                                                            <ul>
                                                                {% for task in holiday.my_tasks|split_string %}
                                                                    <li>{{ task|escape }}</li>  <!-- escape ensures safe rendering -->
                                                                {% empty %}
                                                                    <li>No tasks assigned.</li>
                                                                {% endfor %}
                                                            </ul>
                                                        {% else %}
                                                            <li>No tasks assigned.</li>
                                                        {% endif %}
                                                    </p>
                                                        <p><strong>Status:</strong> {{ holiday.get_status_display }}</p> 
                                                         
                                                        <p><strong>Approved by:</strong>
                                                            {% if holiday.approved_by %}
                                                                {{ holiday.approved_by|join:", " }}
                                                            {% else %}
                                                                None
                                                            {% endif %}
                                                        </p>
                                                        
                                                                   
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% empty %}
                                        <tr>
                                            <td colspan="4">No approved delegated holidays.</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
        
                                <!-- Pagination Controls -->
                                <div class="pagination-controls" id="approved-delegated-holidays-pagination">
                                    <button class="btn btn-secondary" id="prev-approved-delegated-holidays">Previous</button>
                                    <span id="page-number-approved-delegated-holidays">Page 1</span>
                                    <button class="btn btn-secondary" id="next-approved-delegated-holidays">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="alert alert-info">No approved delegated holidays found.</div>
            {% endif %}
        </div>

        <div id="holidays-for-approval-section" style = "display:none">
            {% if holidays_for_approval %}
            <div class="container-fluid" id='holidays-for-approval'>
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                {% if messages %}
                                    {% for message in messages %}
                                        {{ message }}
                                    {% endfor %}
                                {% endif %}
                                <h3 class="card-title">Holidays for Approval</h3>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-bordered" id="holidays-for-approval-table">
                                    <thead>
                                        <tr>
                                            <th>Requester</th>
                                            <th>Holiday Type</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for holiday in holidays_for_approval %}
                                        <tr>
                                            <td>{{ holiday.user.get_full_name }}</td>
                                            <td>{{ holiday.get_holiday_type_display }}</td>
                                            <td>{{ holiday.get_status_display }}</td>
                                            <td>
                                                <button class="btn btn-info" data-toggle="modal" data-target="#approvalHolidayModal-{{ holiday.id }}">View More</button>
                                            </td>
                                        </tr>

                                        <!-- Modal for Holiday for Approval -->
                                        <div class="modal fade" id="approvalHolidayModal-{{ holiday.id }}" tabindex="-1" role="dialog" aria-labelledby="approvalHolidayModalLabel-{{ holiday.id }}" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="approvalHolidayModalLabel-{{ holiday.id }}">Holiday Details</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <p><strong>Requester:</strong> {{ holiday.user.get_full_name }}</p>
                                                        <p><strong>Holiday Type:</strong> {{ holiday.get_holiday_type_display }}</p>
                                                        <p class="duration" 
                                                        data-start-date="{{ holiday.start_date }}" 
                                                        data-end-date="{{ holiday.end_date }}">
                                                        <strong>Duration:</strong>
                                                        {{holiday.start_date }} - {{ holiday.end_date }} 
                                                        <span class="days-text"></span>
                                                     </p>
                                                     <p><strong>His/Her Duty(ies) :</strong>
                                                        {% if holiday.my_tasks %}
                                                            <ul>
                                                                {% for task in holiday.my_tasks|split_string %}
                                                                    <li>{{ task|escape }}</li>  <!-- escape ensures safe rendering -->
                                                                {% empty %}
                                                                    <li>No tasks assigned.</li>
                                                                {% endfor %}
                                                            </ul>
                                                        {% else %}
                                                            <li>No tasks assigned.</li>
                                                        {% endif %}
                                                    </p>
                                                        <p><strong>Status:</strong> {{ holiday.get_status_display }}</p>             
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                        <a href="{% url 'vacation:approve_holiday' holiday.id %}" class="btn btn-success">Approve</a>
                                                        <a href="{% url 'vacation:reject_holiday' holiday.id %}" class="btn btn-danger">Reject</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {% empty %}
                                        <tr>
                                            <td colspan="4">No holidays for approval.</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
        
                                <!-- Pagination Controls -->
                                <div class="pagination-controls" id="holidays-for-approval-pagination">
                                    <button class="btn btn-secondary" id="prev-holidays-for-approval">Previous</button>
                                    <span id="page-number-holidays-for-approval">Page 1</span>
                                    <button class="btn btn-secondary" id="next-holidays-for-approval">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="alert alert-info">No holidays for approval found.</div>
            {% endif %}
        </div>

        <div id="delegated-holidays-section" style = "display:none">
            {% if delegated_holidays %}
            <div class="container-fluid" id='delegated-holidays'>
                <div class="row">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                {% if messages %}
                                    {% for message in messages %}
                                        {{ message }}
                                    {% endfor %}
                                {% endif %}
                                <h3 class="card-title">Delegated Holidays</h3>
                            </div>
                            <div class="table-responsive">
                                <table class="table table-bordered" id="delegated-holidays-table">
                                    <thead>
                                        <tr>
                                            <th>Requester</th>
                                            <th>Holiday Type</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for holiday in delegated_holidays %}
                                        <tr>
                                            <td>{{ holiday.user.get_full_name }}</td>
                                            <td>{{ holiday.get_holiday_type_display }}</td>
                                            <td>{{ holiday.get_status_display }}</td>
                                            <td>
                                                <button class="btn btn-info" data-toggle="modal" data-target="#delegatedHolidayModal-{{ holiday.id }}">View More</button>
                                            </td>
                                        </tr>

                                        <!-- Modal for Delegated Holiday -->
<div class="modal fade" id="delegatedHolidayModal-{{ holiday.id }}" tabindex="-1" role="dialog" aria-labelledby="delegatedHolidayModalLabel-{{ holiday.id }}" aria-hidden="true" aria-modal="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="delegatedHolidayModalLabel-{{ holiday.id }}">Holiday Details</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p><strong>Request From:</strong> {{ holiday.user.get_full_name }}</p>
                <p><strong>Holiday Type:</strong> {{ holiday.get_holiday_type_display }}</p>
                <p class="duration" 
                data-start-date="{{ holiday.start_date }}" 
                data-end-date="{{ holiday.end_date }}">
                <strong>Duration:</strong>
                {{holiday.start_date }} - {{ holiday.end_date }} 
                <span class="days-text"></span>
             </p>

                <p><strong>His Duty(ies) :</strong>
                    {% if holiday.my_tasks %}
                        <ul>
                            {% for task in holiday.my_tasks|split_string %}
                                <li>{{ task|escape }}</li>  <!-- escape ensures safe rendering -->
                            {% empty %}
                                <li>No tasks assigned.</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <li>No tasks assigned.</li>
                    {% endif %}
                </p>
            
            
                

                <p><strong>Status:</strong> {{ holiday.get_status_display }}</p>             
            </div>
            <div class="modal-footer">
                {% if holiday.status == 'pending' %}
                <form method="post" action="{% url 'vacation:approve_delegatee' holiday.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success">Approve as Delegatee</button>
                </form>
            {% elif holiday.status == 'Under Review' %}
                {% if holiday.delegatee_approved %}
                    <form method="post" action="{% url 'vacation:approve_holiday' holiday.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success">Approve</button>
                    </form>
                    <form method="post" action="{% url 'vacation:reject_holiday' holiday.id %}">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger">Reject</button>
                    </form>
                {% else %}
                    <p>Waiting for Delegatee approval before proceeding with other approvals.</p>
                {% endif %}
            {% endif %}
            
            
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

                                        {% empty %}
                                        <tr>
                                            <td colspan="4">No delegated holidays found.</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
        
                                <!-- Pagination Controls -->
                                <div class="pagination-controls" id="delegated-holidays-pagination">
                                    <button class="btn btn-secondary" id="prev-delegated-holidays">Previous</button>
                                    <span id="page-number-delegated-holidays">Page 1</span>
                                    <button class="btn btn-secondary" id="next-delegated-holidays">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="alert alert-info">No delegated holidays found.</div>
            {% endif %}
        </div>
    </section>



<script>
    document.addEventListener('DOMContentLoaded', () => {
        const paginateTable = (tableId, prevBtnId, nextBtnId, pageNumberId) => {
            const rowsPerPage = 2;
            let currentPage = 1;
            const table = document.getElementById(tableId);
            const rows = table.querySelectorAll('tbody tr');
            const totalPages = Math.ceil(rows.length / rowsPerPage);

            const showPage = (page) => {
                rows.forEach((row, index) => {
                    row.style.display = (Math.ceil((index + 1) / rowsPerPage) === page) ? '' : 'none';
                });
                document.getElementById(pageNumberId).textContent = `Page ${page} of ${totalPages}`;
            };

            document.getElementById(prevBtnId).addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    showPage(currentPage);
                }
            });

            document.getElementById(nextBtnId).addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    showPage(currentPage);
                }
            });

            showPage(currentPage);
        };

        paginateTable('user-holidays-table', 'prev-user-holidays', 'next-user-holidays', 'page-number-user-holidays');
        paginateTable('approved-delegated-holidays-table', 'prev-approved-delegated-holidays', 'next-approved-delegated-holidays', 'page-number-approved-delegated-holidays');
        paginateTable('delegated-holidays-table', 'prev-delegated-holidays', 'next-delegated-holidays', 'page-number-delegated-holidays');
        paginateTable('holidays-for-approval-table', 'prev-holidays-for-approval', 'next-holidays-for-approval', 'page-number-holidays-for-approval');
    });



   
        function toggleVisibility(sectionId) {
            const section = document.getElementById(sectionId);
            if (section.style.display === "none" || section.style.display === "") {
                section.style.display = "block";
            } else {
                section.style.display = "none";
            }
        }

    
    
 // Function to calculate difference in days
function calculateDays(startDate, endDate) {
    const start = new Date(startDate);
    const end = new Date(endDate);
    const timeDifference = end - start;
    const daysDifference = timeDifference / (1000 * 3600 * 24) + 1; // Including the end date
    return Math.max(daysDifference, 0); // Ensure we don't show negative days
}

// Function to calculate the difference in days
function calculateDays(startDate, endDate) {
    const start = new Date(startDate);
    const end = new Date(endDate);
    const timeDifference = end - start;
    const daysDifference = timeDifference / (1000 * 3600 * 24) + 1; // Include the end date
    return Math.max(daysDifference, 0); // Ensure we don't show negative days
}

// Function to update the duration for both table and overlay
function updateDurations() {
    // Update durations in the table
    const durationElements = document.querySelectorAll('.duration');

    durationElements.forEach(function(durationElement) {
        const startDate = durationElement.getAttribute('data-start-date');
        const endDate = durationElement.getAttribute('data-end-date');
        const numberOfDays = calculateDays(startDate, endDate);

        const numberOfDaysElement = durationElement.querySelector('.number-of-days');
        numberOfDaysElement.textContent = numberOfDays;
    });

    // Update durations in the overlay
    const overlayDurationElements = document.querySelectorAll('.overlay-duration');

    overlayDurationElements.forEach(function(overlayDurationElement) {
        const startDate = overlayDurationElement.getAttribute('data-start-date');
        const endDate = overlayDurationElement.getAttribute('data-end-date');
        const numberOfDays = calculateDays(startDate, endDate);

        const numberOfDaysElement = overlayDurationElement.querySelector('.number-of-days');
        numberOfDaysElement.textContent = numberOfDays;
    });
}

// Call the function to update durations on page load
document.addEventListener('DOMContentLoaded', updateDurations);




</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Select all elements with the class 'duration'
        const durations = document.querySelectorAll(".duration");
    
        durations.forEach(function(duration) {
            const startDate = new Date(duration.getAttribute("data-start-date"));
            const endDate = new Date(duration.getAttribute("data-end-date"));
            
            // Calculate the difference in time (milliseconds)
            const timeDifference = endDate - startDate;
            
            // Convert time difference to days
            const daysDifference = Math.ceil(timeDifference / (1000 * 3600 * 24));
    
            // Find the span where the number of days will be shown
            const daysText = duration.querySelector(".days-text");
            daysText.textContent = `(${daysDifference} days)`;
        });
    });
    </script>
    
   <style>
    .toggle-container {
        margin-bottom: 20px;
        text-align: center; /* Center text on small screens */
    }
    
    .button-toggle {
        margin: 0 10px; /* Spacing between buttons */
        display: inline-block; /* Allow buttons to sit next to each other */
        position: relative; /* Positioning for hover effects */
    }
    
    .button-toggle input[type="checkbox"] {
        display: none; /* Hide the checkbox */
    }
    
    .btn-text {
        padding: 10px 20px; /* Button padding */
        background-color: #007bff; /* Button color */
        color: white; /* Text color */
        border: none; /* Remove borders */
        border-radius: 5px; /* Rounded corners */
        cursor: pointer; /* Pointer on hover */
        transition: background-color 0.3s; /* Smooth transition */
    }
    
    .btn-text:hover {
        background-color: #0056b3; /* Darker color on hover */
    }
    
    .toggle-content {
        display: none; /* Initially hidden */
        text-align: left; /* Left align content */
    }
    
    /* Show the content when checkbox is checked */
    .toggle-container input[type="checkbox"]:checked ~ .toggle-content {
        display: block; /* Show content */
    }
    
    /* Media Queries for Responsive Design */
    @media (max-width: 768px) {
        .button-toggle {
            display: block; /* Stack buttons vertically on small screens */
            margin: 10px 0; /* Add vertical margin */
        }
    
        .btn-text {
            width: 100%; /* Make buttons full-width */
        }
    
        .toggle-content {
            padding: 10px; /* Add padding to toggle content */
            border: 1px solid #ddd; /* Optional: add border */
            border-radius: 5px; /* Optional: round corners */
            margin-top: 10px; /* Add space above toggle content */
        }
    }
    


    
</style>    
{% endblock %}
